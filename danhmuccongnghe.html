<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh m·ª•c C√¥ng ngh·ªá T∆∞∆°ng lai</title>

    <link rel="stylesheet" href="danhmuccongnghe.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header-tech">
        <h1>Danh m·ª•c C√¥ng ngh·ªá T∆∞∆°ng lai</h1>
    </header>
    <main>
        <div id="product-page" class="section-container">
            <h2 class="section-title">
                S·∫£n ph·∫©m
            </h2>
            <div id="product-search-container">
                <input type="text" id="product-search-input" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m...">
            </div>
            <div id="tech-products-container" class="grid-container"></div>
            
            <div id="product-detail-container">
                <button id="back-to-products-btn" class="back-btn">Quay l·∫°i danh s√°ch s·∫£n ph·∫©m</button>
                <div id="product-detail-content"></div>
            </div>
        </div>
    </main>
    <button id="open-cart-btn" class="cart-btn">
        üõí
        <span id="cart-item-count" class="cart-count-badge">0</span>
    </button>
    <footer>
        <p>&copy; 2025 Creative Hub. M·ªçi quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
    </footer>

    <div id="cart-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="close-cart-btn">&times;</span>
            <h2>Gi·ªè h√†ng c·ªßa b·∫°n</h2>
            <div id="cart-items-container"></div>
            <div class="cart-summary">
                <h3>T·ªïng c·ªông: <span id="cart-total">0 VNƒê</span></h3>
                <button id="checkout-btn" class="checkout-btn">Thanh to√°n</button>
            </div>
        </div>
    </div>
    
    <div id="checkout-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="close-checkout-btn">&times;</span>
            <h2>Th√¥ng tin thanh to√°n</h2>
            <form id="checkout-form">
                <label for="customer-name">H·ªç v√† t√™n:</label>
                <input type="text" id="customer-name" required>
                <label for="customer-address">ƒê·ªãa ch·ªâ:</label>
                <input type="text" id="customer-address" required>
                <label for="customer-phone">S·ªë ƒëi·ªán tho·∫°i:</label>
                <input type="tel" id="customer-phone" required>
                <button type="submit" class="submit-btn">X√°c nh·∫≠n thanh to√°n</button>
            </form>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const techProductsContainer = document.getElementById('tech-products-container');
            const productSearchInput = document.getElementById('product-search-input');
            const productDetailContainer = document.getElementById('product-detail-container');
            const productDetailContent = document.getElementById('product-detail-content');
            const backToProductsBtn = document.getElementById('back-to-products-btn');
            const openCartBtn = document.getElementById('open-cart-btn');
            const cartModal = document.getElementById('cart-modal');
            const cartItemsContainer = document.getElementById('cart-items-container');
            const cartTotal = document.getElementById('cart-total');
            const closeCartBtn = document.getElementById('close-cart-btn');
            const checkoutBtn = document.getElementById('checkout-btn');
            const checkoutModal = document.getElementById('checkout-modal');
            const closeCheckoutBtn = document.getElementById('close-checkout-btn');
            const checkoutForm = document.getElementById('checkout-form');
            const closeBtns = document.querySelectorAll('.close-btn');
            const cartItemCount = document.getElementById('cart-item-count');

            // Data
            let cart = JSON.parse(localStorage.getItem('shoppingCart')) || [];
            let productReviews = JSON.parse(localStorage.getItem('productReviews')) || {};
            let currentUser = localStorage.getItem('currentUser');

            const techProducts = [
                { id: 't1', name: "K√≠nh th·ª±c t·∫ø ·∫£o X-Vision", description: "Tr·∫£i nghi·ªám th·∫ø gi·ªõi ·∫£o s·ªëng ƒë·ªông nh∆∞ th·∫≠t v·ªõi c√¥ng ngh·ªá X-Vision ƒë·ªôt ph√°.", price: "20.000.000 VNƒê", image: "img/congghe/K√≠nh th·ª±c t·∫ø ·∫£o X-Vision.webp", discount: 15 },
                { id: 't2', name: "M√°y bay kh√¥ng ng∆∞·ªùi l√°i Nano-Drone", description: "M√°y bay kh√¥ng ng∆∞·ªùi l√°i si√™u nh·ªè g·ªçn, ƒëi·ªÅu khi·ªÉn b·∫±ng c·ª≠ ch·ªâ tay, ho√†n h·∫£o cho vi·ªác kh√°m ph√° v√† quay phim.", price: "5.000.000 VNƒê", image: "img/congghe/M√°y bay kh√¥ng ng∆∞·ªùi l√°i Nano-Drone.webp", discount: 0 },
                { id: 't3', name: "ƒê·ªìng h·ªì th√¥ng minh Quantum", description: "ƒê·ªìng h·ªì th√¥ng minh v·ªõi m√†n h√¨nh cong linh ho·∫°t, theo d√µi s·ª©c kh·ªèe to√†n di·ªán v√† k·∫øt n·ªëi m·ªçi l√∫c m·ªçi n∆°i.", price: "12.500.000 VNƒê", image: "img/congghe/ƒê·ªìng h·ªì th√¥ng minh Quantum.webp", discount: 20 },
                { id: 't4', name: "Robot tr·ª£ l√Ω gia ƒë√¨nh A-Bot", description: "Robot A-Bot t·ª± ƒë·ªông d·ªçn d·∫πp, n·∫•u ƒÉn v√† l√† ng∆∞·ªùi b·∫°n ƒë·ªìng h√†nh th√¥ng minh cho c·∫£ gia ƒë√¨nh.", price: "35.000.000 VNƒê", image: "img/congghe/Robot tr·ª£ l√Ω gia ƒë√¨nh A-Bot.webp", discount: 10 },
                { id: 't5', name: "B√∫t v·∫Ω 3D Holo-Pen", description: "B√∫t v·∫Ω 3D t·∫°o ra c√°c t√°c ph·∫©m ngh·ªá thu·∫≠t trong kh√¥ng gian, mang ƒë·∫øn m·ªôt tr·∫£i nghi·ªám s√°ng t·∫°o ho√†n to√†n m·ªõi.", price: "8.000.000 VNƒê", image: "img/congghe/B√∫t v·∫Ω 3D Holo-Pen.webp", discount: 0 }
            ];

            // Functions
            function updateCartCount() {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartItemCount.textContent = totalItems;
                cartItemCount.style.display = totalItems > 0 ? 'block' : 'none';
            }

            function saveProductReviews() {
                localStorage.setItem('productReviews', JSON.stringify(productReviews));
            }

            function renderTechProducts(productsToRender = techProducts) {
                techProductsContainer.innerHTML = '';
                productsToRender.forEach(product => {
                    let priceHtml = `<p class="product-price">Gi√°: ${product.price}</p>`;
                    if (product.discount > 0) {
                        const originalPrice = parseInt(product.price.replace(/\./g, '').replace(' VNƒê', ''));
                        const discountedPrice = originalPrice * (1 - product.discount / 100);
                        priceHtml = `
                            <p class="product-price-old">Gi√° c≈©: ${originalPrice.toLocaleString('vi-VN')} VNƒê</p>
                            <p class="product-price">Gi√° KM: ${discountedPrice.toLocaleString('vi-VN')} VNƒê</p>
                            <span class="product-discount-badge">-${product.discount}%</span>
                        `;
                    }

                    const productElement = document.createElement('div');
                    productElement.classList.add('product-item');
                    productElement.innerHTML = `
                        <img src="${product.image}" alt="${product.name}">
                        <div class="product-info">
                            <h3>${product.name}</h3>
                            <p>${product.description}</p>
                            ${priceHtml}
                        </div>
                        <div class="product-actions">
                            <button class="add-to-cart-btn" data-id="${product.id}">Th√™m v√†o gi·ªè</button>
                            <button class="view-detail-btn" data-id="${product.id}">Xem chi ti·∫øt</button>
                        </div>
                    `;
                    techProductsContainer.appendChild(productElement);
                });

                document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = e.currentTarget.dataset.id;
                        addToCart(productId);
                    });
                });

                document.querySelectorAll('.view-detail-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = e.currentTarget.dataset.id;
                        renderProductDetail(productId);
                    });
                });
            }

            function renderProductDetail(productId) {
                const product = techProducts.find(p => p.id === productId);
                if (product) {
                    let priceHtml = `<p class="detail-price">Gi√°: ${product.price}</p>`;
                    if (product.discount > 0) {
                        const originalPrice = parseInt(product.price.replace(/\./g, '').replace(' VNƒê', ''));
                        const discountedPrice = originalPrice * (1 - product.discount / 100);
                        priceHtml = `
                            <p class="detail-price-old">Gi√° c≈©: ${originalPrice.toLocaleString('vi-VN')} VNƒê</p>
                            <p class="detail-price">Gi√° KM: ${discountedPrice.toLocaleString('vi-VN')} VNƒê <span class="product-discount-badge">-${product.discount}%</span></p>
                        `;
                    }

                    const reviews = productReviews[productId] || [];
                    let reviewsHtml = '';
                    if (reviews.length > 0) {
                        reviewsHtml = '<h4 class="reviews-title">ƒê√°nh gi√° s·∫£n ph·∫©m:</h4><ul class="reviews-list">';
                        reviews.forEach(review => {
                            reviewsHtml += `<li><strong>${review.author}</strong>: ${review.text}</li>`;
                        });
                        reviewsHtml += '</ul>';
                    } else {
                        reviewsHtml = '<p class="no-reviews">Ch∆∞a c√≥ ƒë√°nh gi√° n√†o cho s·∫£n ph·∫©m n√†y.</p>';
                    }

                    productDetailContent.innerHTML = `
                        <img src="${product.image}" alt="${product.name}" class="detail-image">
                        <div class="detail-info">
                            <h3 class="detail-title">${product.name}</h3>
                            <p class="detail-description">${product.description}</p>
                            ${priceHtml}
                        </div>
                        <button class="add-to-cart-btn" data-id="${product.id}">Th√™m v√†o gi·ªè</button>
                        <div id="review-section">
                            ${reviewsHtml}
                            <form id="review-form">
                                <input type="text" id="review-input" placeholder="Vi·∫øt ƒë√°nh gi√° c·ªßa b·∫°n..." required>
                                <button type="submit" class="review-submit-btn">G·ª≠i</button>
                            </form>
                        </div>
                    `;
                    techProductsContainer.style.display = 'none';
                    productDetailContainer.style.display = 'block';

                    const addToCartBtn = document.querySelector('#product-detail-content .add-to-cart-btn');
                    addToCartBtn.addEventListener('click', (e) => {
                        const productId = e.currentTarget.dataset.id;
                        addToCart(productId);
                    });

                    const reviewForm = document.getElementById('review-form');
                    reviewForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        if (!currentUser) {
                            alert("Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ ƒë√°nh gi√° s·∫£n ph·∫©m!");
                            return;
                        }
                        const reviewText = document.getElementById('review-input').value;
                        if (!productReviews[productId]) {
                            productReviews[productId] = [];
                        }
                        productReviews[productId].push({ author: currentUser, text: reviewText });
                        saveProductReviews();
                        renderProductDetail(productId);
                    });
                }
            }

            function addToCart(productId) {
                const product = techProducts.find(p => p.id === productId);
                if (product) {
                    const existingItem = cart.find(item => item.id === productId);
                    if (existingItem) {
                        existingItem.quantity += 1;
                    } else {
                        cart.push({ ...product, quantity: 1 });
                    }
                    saveCart();
                    updateCartCount();
                    alert(`${product.name} ƒë√£ ƒë∆∞·ª£c th√™m v√†o gi·ªè h√†ng!`);
                }
            }

            function saveCart() {
                localStorage.setItem('shoppingCart', JSON.stringify(cart));
            }

            function renderCart() {
                cartItemsContainer.innerHTML = '';
                let total = 0;
                if (cart.length === 0) {
                    cartItemsContainer.innerHTML = '<p>Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng.</p>';
                    cartTotal.innerText = '0 VNƒê';
                } else {
                    cart.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.classList.add('cart-item');
                        const priceValue = parseInt(item.price.replace(/\./g, '').replace(' VNƒê', ''));
                        const itemTotal = priceValue * item.quantity;
                        total += itemTotal;
                        itemElement.innerHTML = `
                            <div class="cart-item-info">
                                <p>${item.name}</p>
                                <p class="cart-item-price">Gi√°: ${item.price}</p>
                            </div>
                            <div class="cart-item-quantity">
                                <button class="quantity-btn decrease-btn" data-id="${item.id}">-</button>
                                <span>${item.quantity}</span>
                                <button class="quantity-btn increase-btn" data-id="${item.id}">+</button>
                            </div>
                            <button class="remove-from-cart-btn" data-id="${item.id}">X√≥a</button>
                        `;
                        cartItemsContainer.appendChild(itemElement);
                    });
                    cartTotal.innerText = `${total.toLocaleString('vi-VN')} VNƒê`;
                    
                    document.querySelectorAll('.quantity-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            const productId = e.currentTarget.dataset.id;
                            const action = e.currentTarget.classList.contains('increase-btn') ? 'increase' : 'decrease';
                            updateCartQuantity(productId, action);
                        });
                    });
                    
                    document.querySelectorAll('.remove-from-cart-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            const productId = e.currentTarget.dataset.id;
                            removeFromCart(productId);
                        });
                    });
                }
            }
            
            function updateCartQuantity(productId, action) {
                const itemToUpdate = cart.find(item => item.id === productId);
                if (itemToUpdate) {
                    if (action === 'increase') {
                        itemToUpdate.quantity += 1;
                    } else if (action === 'decrease' && itemToUpdate.quantity > 1) {
                        itemToUpdate.quantity -= 1;
                    } else if (action === 'decrease' && itemToUpdate.quantity === 1) {
                        removeFromCart(productId);
                        return;
                    }
                    saveCart();
                    renderCart();
                    updateCartCount();
                }
            }

            function removeFromCart(productId) {
                const confirmRemove = confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫£n ph·∫©m n√†y kh·ªèi gi·ªè h√†ng kh√¥ng?");
                if (confirmRemove) {
                    cart = cart.filter(item => item.id !== productId);
                    saveCart();
                    renderCart();
                    updateCartCount();
                }
            }

            productSearchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                const filteredProducts = techProducts.filter(product =>
                    product.name.toLowerCase().includes(query) ||
                    product.description.toLowerCase().includes(query)
                );
                renderTechProducts(filteredProducts);
            });
            
            backToProductsBtn.addEventListener('click', () => {
                techProductsContainer.style.display = 'grid';
                productDetailContainer.style.display = 'none';
            });
            
            openCartBtn.addEventListener('click', () => {
                cartModal.style.display = 'block';
                renderCart();
            });

            closeCartBtn.addEventListener('click', () => {
                cartModal.style.display = 'none';
            });

            checkoutBtn.addEventListener('click', () => {
                if (cart.length > 0) {
                    cartModal.style.display = 'none';
                    checkoutModal.style.display = 'block';
                } else {
                    alert("Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng!");
                }
            });

            closeCheckoutBtn.addEventListener('click', () => {
                checkoutModal.style.display = 'none';
            });

            checkoutForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const customerName = document.getElementById('customer-name').value;
                const customerAddress = document.getElementById('customer-address').value;
                const customerPhone = document.getElementById('customer-phone').value;
                
                alert(`C·∫£m ∆°n anh ${customerName}! ƒê∆°n h√†ng c·ªßa anh ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n. Ch√∫ng em s·∫Ω giao ƒë·∫øn ƒë·ªãa ch·ªâ ${customerAddress} s·ªõm nh·∫•t. T·ªïng ti·ªÅn l√† ${cartTotal.innerText}.`);
                
                cart = [];
                saveCart();
                checkoutModal.style.display = 'none';
                renderCart();
                updateCartCount();
            });
            
            closeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    cartModal.style.display = "none";
                    checkoutModal.style.display = "none";
                });
            });

            window.addEventListener('click', (event) => {
                if (event.target == cartModal) {
                    cartModal.style.display = "none";
                }
                if (event.target == checkoutModal) {
                    checkoutModal.style.display = "none";
                }
            });
            
            renderTechProducts();
            updateCartCount();
        });
    </script>
</body>
</html>